# Program 5: Perform Cross-Validation and calculate RMSE, MAE, and R2

import numpy as np
from sklearn.datasets import fetch_california_housing
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split, KFold, cross_val_score
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

# Load California Housing dataset
x, y = fetch_california_housing(return_X_y=True)

# Create Linear Regression model
model = LinearRegression()

# Split data into training and testing sets (80% train, 20% test)
xtr, xte, ytr, yte = train_test_split(x, y, test_size=0.2, random_state=0)

# Train the model
model.fit(xtr, ytr)

# Predict values for test set
pred = model.predict(xte)

# ---- Validation Metrics ----
rmse = np.sqrt(mean_squared_error(yte, pred))   # Root Mean Square Error
mae = mean_absolute_error(yte, pred)            # Mean Absolute Error
r2 = r2_score(yte, pred)                        # R2 Score

print("Val RMSE:", rmse, "MAE:", mae, "R2:", r2)

# ---- 5-Fold Cross Validation ----
kf = KFold(n_splits=5, shuffle=True, random_state=0)

# Cross-validated RMSE
rmse = np.sqrt(
    -cross_val_score(model, x, y, cv=kf, scoring='neg-mean-squared-error')
).mean()

# Cross-validated MAE
mae = -cross_val_score(model, x, y, cv=kf, scoring='neg-mean-absolute-error').mean()

# Cross-validated RÂ²
r2 = cross_val_score(model, x, y, cv=kf, scoring='r2').mean()

print("5-fold RMSE:", rmse, "MAE:", mae, "R2:", r2)
